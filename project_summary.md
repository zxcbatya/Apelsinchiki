# Проект оптимизации цен на поездки - Резюме

## Постановка задачи

Построить модель нейронной сети, которая прогнозирует вероятность того, что пассажир примет предложение водителя по цене: P(is_done=1|x,price_bid_local), и использовать эту модель для определения оптимальных стратегий ценообразования.

## Подход

### 1. Анализ данных
- Загрузка и исследование набора данных, содержащего более 50 000 заказов на поездки
- Изучение признаков, включая расстояние, продолжительность, рейтинг водителя, информацию об автомобиле, платформу и цены
- Анализ взаимосвязи между изменением цен и уровнем принятия заказов

### 2. Создание признаков
Созданы производные признаки для повышения производительности модели:
- Процент увеличения цены: (price_bid_local - price_start_local) / price_start_local
- Абсолютная разница в цене: price_bid_local - price_start_local
- Цена за км: price_bid_local / (distance_in_meters / 1000)
- Цена за минуту: price_bid_local / (duration_in_seconds / 60)
- Расстояние в км и продолжительность в минутах
- Расстояние подачи в км и время подачи в минутах

### 3. Разработка модели
- Построена нейронная сеть с 3 скрытыми слоями (128, 64, 32 нейрона)
- Использован Dropout для регуляризации во избежание переобучения
- Применено стандартное масштабирование к числовым признакам
- Кодирование категориальных переменных с использованием label encoding
- Обучение с бинарной кросс-энтропией потерь и оптимизатором Adam

### 4. Оптимизация цен
- Реализована функция для определения оптимальных стратегий ценообразования
- Для данного заказа оценивается несколько кандидатов в цены
- Для каждого кандидата в цены рассчитывается вероятность принятия с использованием модели
- Рассчитывается ожидаемый доход как цена × вероятность
- Выбирается цена, максимизирующая ожидаемый доход

## Основные компоненты

### Предобработка данных
- Обработка пропущенных значений в рейтинге водителей путем заполнения медианой
- Преобразование категориальных переменных в числовые с помощью кодирования меток
- Масштабирование числовых признаков с использованием StandardScaler

### Архитектура нейронной сети
```
Входной слой (15 признаков)
├── Плотный слой (128 нейронов, активация ReLU)
├── Dropout (0.3)
├── Плотный слой (64 нейрона, активация ReLU)
├── Dropout (0.3)
├── Плотный слой (32 нейрона, активация ReLU)
├── Dropout (0.2)
└── Выходной слой (1 нейрон, сигмоидальная активация)
```

### Процесс обучения
- Разделение данных на обучающую (80%) и тестовую (20%) выборки
- Использование 20% обучающих данных для валидации
- Обучение в течение 50 эпох с размером батча 32
- Мониторинг метрик потерь и точности

### Алгоритм оптимизации цен
1. Для нового заказа с определенными признаками определить диапазон кандидатов в цены
2. Для каждого кандидата в цены:
   - Обновить признаки, связанные с ценой
   - Прогнозировать вероятность принятия с использованием обученной модели
   - Рассчитать ожидаемый доход = цена × вероятность
3. Выбрать цену, максимизирующую ожидаемый доход

## Результаты

Модель успешно научилась прогнозировать вероятность принятия заказа на основе признаков заказа и цен. Компонент оптимизации цен затем может использоваться для:

1. Максимизации ожидаемого дохода для новых заказов
2. Предоставления рекомендаций по ценообразованию на основе данных
3. Баланса между более высокими ценами (больше дохода на заказ) и более низкими ценами (более высокие уровни принятия)

## Инструкции по использованию

1. Установить необходимые пакеты: `pip install -r requirements.txt`
2. Запустить исследование данных: `python data_exploration.py`
3. Обучить модель: `python model.py`
4. Для интерактивного анализа откройте `pricing_model.ipynb` в Jupyter Notebook

## Будущие улучшения

1. **Создание признаков**: Добавить более сложные признаки, такие как временные признаки, метрики производительности водителя и т.д.
2. **Настройка модели**: Поэкспериментировать с различными архитектурами, гиперпараметрами и методами регуляризации
3. **Ансамблевые методы**: Объединить несколько моделей для лучшей производительности
4. **Интеграция в реальном времени**: Реализовать модель в системе ценообразования в реальном времени
5. **A/B тестирование**: Проверить прогнозы модели с помощью реальных экспериментов

## Заключение

Этот проект успешно реализует модель нейронной сети для прогнозирования вероятностей принятия заказов на поездки и использует ее для оптимизации стратегий ценообразования. Подход балансирует между методами машинного обучения и бизнес-целями для максимизации ожидаемого дохода при поддержании высоких уровней принятия.