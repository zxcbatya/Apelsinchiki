# Оптимизация цен на поездки

Этот проект реализует нейронную сеть для прогнозирования вероятности того, что пассажир примет предложение водителя по цене, а затем использует эту модель для определения оптимальных стратегий ценообразования.

## Обзор

Модель прогнозирует P(is_done=1|x,price_bid_local), где:
- `is_done` - целевая переменная, указывающая, был ли заказ выполнен (done) или отменен (cancel)
- `x` представляет собой различные характеристики заказа на поездку
- `price_bid_local` - предложенная водителем цена

После обучения модель может использоваться для определения оптимальных цен, максимизирующих ожидаемый доход.

## Набор данных

Набор данных содержит информацию о заказах поездок со следующими ключевыми характеристиками:
- Детали заказа (расстояние, продолжительность, расстояние/время подачи)
- Информация о водителе (рейтинг, модель автомобиля, марка автомобиля)
- Информация о платформе
- Информация о ценах (price_start_local, price_bid_local)
- Целевая переменная (is_done: done/cancel)

## Созданные признаки

Модель использует следующие признаки:
1. Необработанные признаки из набора данных
2. Производные признаки:
   - Процент увеличения цены: (price_bid_local - price_start_local) / price_start_local
   - Абсолютная разница в цене: price_bid_local - price_start_local
   - Цена за км: price_bid_local / (distance_in_meters / 1000)
   - Цена за минуту: price_bid_local / (duration_in_seconds / 60)
   - Расстояние в км и продолжительность в минутах
   - Расстояние подачи в км и время подачи в минутах

## Архитектура модели

Нейронная сеть состоит из:
- Входного слоя с признаками
- 3 скрытых слоев (128, 64 и 32 нейрона соответственно)
- Слоев Dropout для регуляризации
- Выходного слоя с сигмоидальной активацией для бинарной классификации

## Использование

### Исследование данных
Запустите `data_exploration.py` для понимания набора данных:
```bash
python data_exploration.py
```

### Генерация визуализаций
Запустите `visualize_data.py` для создания визуализаций данных:
```bash
python visualize_data.py
```

### Обучение модели
Запустите `model.py` для обучения нейронной сети:
```bash
python model.py
```

### Оценка модели
Запустите `model_evaluation.py` для комплексной оценки модели:
```bash
python model_evaluation.py
```

### Прогнозирование для новых заказов
После обучения используйте `predict_new_orders.py` для прогнозирования по новым заказам:
```bash
python predict_new_orders.py
```

### Использование Jupyter Notebook
Откройте `pricing_model.ipynb` в Jupyter Notebook для интерактивного анализа:
```bash
jupyter notebook pricing_model.ipynb
```

## Требования

- Python 3.x
- pandas
- numpy
- scikit-learn
- tensorflow
- matplotlib
- seaborn
- jupyter (для notebook)

Установите требования с помощью:
```bash
pip install -r requirements.txt
```

## Файлы

- `train.csv`: Обучающий набор данных
- `model.py`: Основной скрипт для обучения модели
- `data_exploration.py`: Скрипт для анализа данных
- `visualize_data.py`: Скрипт для визуализации данных
- `predict_new_orders.py`: Скрипт демонстрации использования модели
- `model_evaluation.py`: Скрипт комплексной оценки модели
- `pricing_model.ipynb`: Jupyter notebook для интерактивного анализа
- `pricing_model.h5`: Сохраненная обученная модель
- `training_history.png`: Кривые обучения/валидации
- `README.md`: Этот файл

## Результаты

Модель успешно справляется с задачей бинарной классификации прогнозирования принятия пассажиром предложения водителя. Компонент оптимизации цен затем может использоваться для максимизации ожидаемого дохода для новых заказов.